!function(e){function t(t,i,l,o,r,s){return function(n){function c(l,r){var s=t.$new(!0),n=["<div modal"];e.forEach(r,function(e,t){s[t]=e,n.push(t+'="'+t+'"')}),n.push("/>");var c=i(n.join(" "))(s);s=c.children().scope(),s.service=!0,s.promise.then(a.resolve,a.reject),o.find("body").append(c)}var a=l.defer(),d=n.template||s.get(n.templateUrl);return d?c(d,n):r.get(n.templateUrl).success(function(e){s.put(n.templateUrl,e),c(e,n)}),a.promise}}e.module("modal",[]),e.module("modal").directive("modal",function(e,t,i,l,o){var r=i.find("body");return{restrict:"A",transclude:"true",scope:{width:"&?",height:"&?",template:"&?",templateUrl:"&?",scope:"=?",controller:"&?"},template:'<div class="modal-clickbait"></div><div class="modal-focus"></div>',require:"modal",controllerAs:"modal",controller:function(e,t){function i(){r.children().removeClass("modal-blur"),modal=!1,e.service&&e.el.remove()}this.link=function(t){e.el=t};var l=t.defer();this.promise=l.promise,this.close=function(){l.resolve(),i()},this.dismiss=function(){l.reject(),i()},this.blur=function(t){r.children().addClass("modal-blur");for(var i=t;i.length;)i.removeClass("modal-blur"),i=i.parent();e.$close=this.close,e.$dismiss=this.dismiss,e.promise=this.promise,e.blur=this.blur}},link:function(e,r,s,n,c){var a=r.children()[0],d=!0;n.link(r),n.blur(r);var u=function p(e){27===e.which&&(i.off("keyup",p),n.dismiss())};i.on("keyup",u);var m=function f(e){e.target===a&&(i.off("click",f),n.dismiss())};i.on("click",m),c(function(i){function s(e){var t=e.scope();t.$close=n.close.bind(n),t.$dismiss=n.dismiss.bind(n),r.find("div").append(e),e.on("$destroy",function(){delete t.$close,d&&(d=!1,n.close())})}if(e.template()||e.templateUrl()){var c=e.template()||l.get(e.templateUrl());c?s(t(c)(e.scope||e,e.controller())):(o.get(e.templateUrl()).success(function(t){l.put(e.templateUrl(),t)}),s(t(c)(e.scope||e,e.controller())))}else s(i)})}}}),e.module("modal").provider("modal",function(){this.$get=function(e,i,l,o,r,s){return t(e,i,l,o,r,s)}})}(angular);